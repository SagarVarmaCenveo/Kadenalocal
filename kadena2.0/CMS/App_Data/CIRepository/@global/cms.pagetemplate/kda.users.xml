<?xml version="1.0" encoding="utf-8"?>
<cms.pagetemplate>
  <PageTemplateCategoryID>
    <CodeName>Kadena_Content</CodeName>
    <GUID>bc866ad9-edd3-4fef-8661-dc36de54fc3d</GUID>
    <ObjectType>cms.pagetemplatecategory</ObjectType>
  </PageTemplateCategoryID>
  <PageTemplateCodeName>KDA.Users</PageTemplateCodeName>
  <PageTemplateDescription />
  <PageTemplateDisplayName>_Users</PageTemplateDisplayName>
  <PageTemplateFile />
  <PageTemplateGUID>6b8522de-4535-4338-a2b9-5d5afbcf15ea</PageTemplateGUID>
  <PageTemplateHeader />
  <PageTemplateIconClass>icon-l-text</PageTemplateIconClass>
  <PageTemplateInheritPageLevels>/{0}</PageTemplateInheritPageLevels>
  <PageTemplateIsReusable>True</PageTemplateIsReusable>
  <PageTemplateLayout>
<![CDATA[
<div class="content-header">
  {^WebPartZone|(id)zoneHeader^}
</div>
<div class="content-block">
  {^WebPartZone|(id)zoneTextBefore^}
  
  {^WebPartZone|(id)zoneContent^}
  
  {^WebPartZone|(id)zoneTextAfter^}
  
</div>
<!--pop up html-->
<div class="dialog modal_businessunit" id="businessUnitPopup">  
  <div class="dialog__shadow"></div>
  <div class="dialog__block">    
    <div class="dialog__header">      
      <a href="#" class="btn-action js-btnSaveBU">{$Kadena.BuinessUnit.AddBusinessUnits$}</a>
      <a href="#" class="btn__close js-btnClose"><i class="fa fa-close"></i></a>      
    </div>    
    <div class="dialog__content">      
      <table class="table" id="buinessunits">
        <tbody id="buinessunitsbody">
          <tr>
            <td>
              <input type="checkbox" class="js-chkAll" id="selectAll">
            </td>            
            <td>{$Kadena.Users.BusinessUnitNumber$}</td>
            <td>{$Kadena.Users.BusinessUnitName$}</td>
          </tr>
        </tbody>
      </table>      
    </div>    
    <div class="dialog__footer">      
      <div class="btn-group btn-group--right">                         
      </div>          
    </div>      
  </div>    
</div>

]]>
  </PageTemplateLayout>
  <PageTemplateLayoutType>html</PageTemplateLayoutType>
  <PageTemplateShowAsMasterTemplate>False</PageTemplateShowAsMasterTemplate>
  <PageTemplateType>portal</PageTemplateType>
  <PageTemplateWebParts>
    <page>
      <webpartzone id="zoneContent">
        <properties>
          <property name="containerhideonsubpages">False</property>
          <property name="disableviewstate">False</property>
          <property name="hideonsubpages">False</property>
          <property name="timezonetype">inherit</property>
          <property name="useupdatepanel">False</property>
          <property name="visible">True</property>
        </properties>
        <webpart controlid="UsersList" guid="c2428cff-5d35-47c5-8dda-5757a9399bb7" type="KDA.UsersList" v="1">
          <property name="alternatingitemtransformationname"></property>
          <property name="alternativeform">cms.user.KDA_NewEditUser</property>
          <property name="cachedependencies">
<![CDATA[
##DEFAULT##

]]>
          </property>
          <property name="cacheitemname"></property>
          <property name="cacheminutes"></property>
          <property name="cat_open_ajax"></property>
          <property name="cat_open_output_filter"></property>
          <property name="cat_open_performance"></property>
          <property name="cat_open_time zones"></property>
          <property name="cat_open_visibility">False</property>
          <property name="columns"></property>
          <property name="container"></property>
          <property name="containercssclass"></property>
          <property name="containercustomcontent"></property>
          <property name="containerhideonsubpages">False</property>
          <property name="containertitle"></property>
          <property name="contentafter"></property>
          <property name="contentbefore"></property>
          <property name="controlid">UsersList</property>
          <property name="currentpage">KDA.Transformations.General-CurrentPage</property>
          <property name="customtimezone"></property>
          <property name="directpage"></property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">False</property>
          <property name="displayfirstlastautomatically">False</property>
          <property name="displaypreviousnextautomatically">False</property>
          <property name="displaytoroles"></property>
          <property name="edituseralternativeform">cms.user.KDA_EditUser</property>
          <property name="enableoutputfilter">False</property>
          <property name="enablepaging">True</property>
          <property name="filtername"></property>
          <property name="firstpage"></property>
          <property name="footertransformationname">KDA.Transformations.UsersFooter</property>
          <property name="groupsize">10</property>
          <property name="headertransformationname">KDA.Transformations.UsersHeader</property>
          <property name="hidecontrolforzerorows">False</property>
          <property name="hideonsubpages">False</property>
          <property name="hidepagerforsinglepage">True</property>
          <property name="instanceguid">c2428cff-5d35-47c5-8dda-5757a9399bb7</property>
          <property name="lastpage"></property>
          <property name="newuseralternativeform">cms.user.KDA_NewUser</property>
          <property name="newuserbuttontext" ismacro="true">{$Kadena.Users.NewUser$}</property>
          <property name="newuserrole">AAAA_CustomRole</property>
          <property name="nextgroup"></property>
          <property name="nextpage">KDA.Transformations.General-NextPage</property>
          <property name="orderby"></property>
          <property name="outputconverttablestodivs">none</property>
          <property name="outputfixattributes">True</property>
          <property name="outputfixhtml5">True</property>
          <property name="outputfixjavascript">True</property>
          <property name="outputfixlowercase">True</property>
          <property name="outputfixselfclose">True</property>
          <property name="outputresolveurls">True</property>
          <property name="pagerlayout">KDA.Transformations.Kadena-PagerLayout</property>
          <property name="pages">KDA.Transformations.General-Pages</property>
          <property name="pageseparator"></property>
          <property name="pagesize">25</property>
          <property name="pagingmode">querystring</property>
          <property name="partialcachedependencies">
<![CDATA[
##DEFAULT##

]]>
          </property>
          <property name="partialcacheminutes">0</property>
          <property name="preservepartialcacheonpostback">False</property>
          <property name="previousgroup"></property>
          <property name="previouspage">KDA.Transformations.General-PreviousPage</property>
          <property name="querystringkey">page</property>
          <property name="selecthidden">True</property>
          <property name="selectonlyapproved">False</property>
          <property name="selecttopn"></property>
          <property name="separatortransformationname"></property>
          <property name="showfiltercontrol">True</property>
          <property name="showfordocumenttypes"></property>
          <property name="sitename"></property>
          <property name="timezonetype">inherit</property>
          <property name="transformationname">KDA.Transformations.Users</property>
          <property name="userpageurl">~/Users/User</property>
          <property name="useupdatepanel">False</property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">KDA.UsersList</property>
          <property name="wherecondition">UserPrivilegeLevel!=3</property>
          <property name="zerorowstext" ismacro="true">
<![CDATA[
<div class=" mt-2">
    <div data-reactroot="" class="alert--info alert--full alert--smaller isOpen"><span>{$Kadena.ItemList.NoDataFoundText$}</span></div>
</div>
]]>
          </property>
        </webpart>
      </webpartzone>
      <webpartzone id="zoneHeader" v="1">
        <webpart controlid="Header" guid="d2dceb9c-77ad-4ab1-8aac-e666cd61ceb2" type="statictext" v="1">
          <property name="cat_open_ajax"></property>
          <property name="cat_open_output_filter">False</property>
          <property name="cat_open_performance">False</property>
          <property name="cat_open_time zones"></property>
          <property name="cat_open_visibility"></property>
          <property name="container"></property>
          <property name="containercssclass"></property>
          <property name="containercustomcontent"></property>
          <property name="containerhideonsubpages">False</property>
          <property name="containertitle"></property>
          <property name="contentafter">
<![CDATA[
</h1>
</div>
]]>
          </property>
          <property name="contentbefore">
<![CDATA[
<div class="content-header__inner">
<h1 class="content-header__page-name">
]]>
          </property>
          <property name="controlid">Header</property>
          <property name="customtimezone"></property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">True</property>
          <property name="displaytoroles"></property>
          <property name="enableoutputfilter">False</property>
          <property name="encodetext">False</property>
          <property name="hideonsubpages">False</property>
          <property name="instanceguid">d2dceb9c-77ad-4ab1-8aac-e666cd61ceb2</property>
          <property name="outputconverttablestodivs">none</property>
          <property name="outputfixattributes">False</property>
          <property name="outputfixhtml5">False</property>
          <property name="outputfixjavascript">False</property>
          <property name="outputfixlowercase">False</property>
          <property name="outputfixselfclose">False</property>
          <property name="outputresolveurls">False</property>
          <property name="partialcachedependencies">
<![CDATA[
##DEFAULT##

]]>
          </property>
          <property name="partialcacheminutes"></property>
          <property name="positionleft"></property>
          <property name="positiontop"></property>
          <property name="preservepartialcacheonpostback">True</property>
          <property name="resolvedynamiccontrols">False</property>
          <property name="showfordocumenttypes"></property>
          <property name="tag"></property>
          <property name="text">{%DocumentName%}</property>
          <property name="timezonetype">inherit</property>
          <property name="useupdatepanel">False</property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">statictext</property>
        </webpart>
        <webpart controlid="Breadcrumbs" guid="06690fcd-b6a8-4c56-bbd0-8d9c20ed2681" type="statictext" v="1">
          <property name="cat_open_ajax"></property>
          <property name="cat_open_output_filter">False</property>
          <property name="cat_open_performance">False</property>
          <property name="cat_open_time zones"></property>
          <property name="cat_open_visibility"></property>
          <property name="container"></property>
          <property name="containercssclass"></property>
          <property name="containercustomcontent"></property>
          <property name="containerhideonsubpages">False</property>
          <property name="containertitle"></property>
          <property name="contentafter"></property>
          <property name="contentbefore"></property>
          <property name="controlid">Breadcrumbs</property>
          <property name="customtimezone"></property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">True</property>
          <property name="displaytoroles"></property>
          <property name="enableoutputfilter">False</property>
          <property name="encodetext">False</property>
          <property name="hideonsubpages">False</property>
          <property name="instanceguid">06690fcd-b6a8-4c56-bbd0-8d9c20ed2681</property>
          <property name="outputconverttablestodivs">none</property>
          <property name="outputfixattributes">False</property>
          <property name="outputfixhtml5">False</property>
          <property name="outputfixjavascript">False</property>
          <property name="outputfixlowercase">False</property>
          <property name="outputfixselfclose">False</property>
          <property name="outputresolveurls">False</property>
          <property name="partialcachedependencies">
<![CDATA[
##DEFAULT##

]]>
          </property>
          <property name="partialcacheminutes"></property>
          <property name="positionleft"></property>
          <property name="positiontop"></property>
          <property name="preservepartialcacheonpostback">True</property>
          <property name="resolvedynamiccontrols">False</property>
          <property name="showfordocumenttypes"></property>
          <property name="tag"></property>
          <property name="text" ismacro="true">
<![CDATA[
{%
result = "<a href='" + CurrentDocument.AbsoluteURL + "'>" + CurrentDocument.DocumentName + "</a>";
iteratedDocument = CurrentDocument.Parent;
while (iteratedDocument.Parent != null) {
result = String.FormatString("{0}{1}", "<a href='" + iteratedDocument.AbsoluteURL + "'>" + iteratedDocument.DocumentName + "</a>", result);
iteratedDocument = iteratedDocument.Parent;
};
"<div class='breadcrumbs'>" + result + "</div>"
|(user)administrator|(hash)6bfc4283a297cf1dac98542bb0d719e1a27d1c7ac39cab2d6f5aae2e8ba69c23%}
]]>
          </property>
          <property name="timezonetype">inherit</property>
          <property name="useupdatepanel">False</property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">statictext</property>
        </webpart>
      </webpartzone>
      <webpartzone id="zoneTextBefore" v="1">
        <webpart controlid="TextBeforeForm" guid="01f2d18f-4b57-4cdb-9f1c-0379af3f7e37" type="editabletext" v="1">
          <property name="cat_open_ajax"></property>
          <property name="cat_open_output_filter"></property>
          <property name="cat_open_performance">False</property>
          <property name="cat_open_time zones"></property>
          <property name="cat_open_visibility"></property>
          <property name="checkpermissions">False</property>
          <property name="container"></property>
          <property name="containercssclass"></property>
          <property name="containercustomcontent"></property>
          <property name="containerhideonsubpages">False</property>
          <property name="containertitle"></property>
          <property name="contentafter"></property>
          <property name="contentbefore"></property>
          <property name="controlid">TextBeforeForm</property>
          <property name="customtimezone"></property>
          <property name="defaulttext"></property>
          <property name="dialogheight"></property>
          <property name="dialogwidth"></property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">True</property>
          <property name="displaytoroles"></property>
          <property name="enableoutputfilter">False</property>
          <property name="encodetext">False</property>
          <property name="hideonsubpages">False</property>
          <property name="htmlareatoolbar"></property>
          <property name="htmlareatoolbarlocation">Out:FCKToolbar</property>
          <property name="imageautoresize">
<![CDATA[
<AutoResize>
  <autoresize>noresize</autoresize>
  <autoresize_width />
  <autoresize_height />
  <autoresize_maxsidesize />
</AutoResize>
]]>
          </property>
          <property name="instanceguid">01f2d18f-4b57-4cdb-9f1c-0379af3f7e37</property>
          <property name="maxlength"></property>
          <property name="minlength"></property>
          <property name="outputconverttablestodivs">none</property>
          <property name="outputfixattributes">True</property>
          <property name="outputfixhtml5">True</property>
          <property name="outputfixjavascript">True</property>
          <property name="outputfixlowercase">True</property>
          <property name="outputfixselfclose">True</property>
          <property name="outputresolveurls">True</property>
          <property name="partialcachedependencies">
<![CDATA[
##DEFAULT##

]]>
          </property>
          <property name="partialcacheminutes"></property>
          <property name="preservepartialcacheonpostback">True</property>
          <property name="regiontitle">Text before form</property>
          <property name="regiontype">HtmlEditor</property>
          <property name="resolvedynamiccontrols">False</property>
          <property name="selectonlypublished">False</property>
          <property name="showfordocumenttypes"></property>
          <property name="timezonetype">inherit</property>
          <property name="useparentcontent">False</property>
          <property name="useupdatepanel">False</property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">editabletext</property>
          <property name="wordwrap">True</property>
        </webpart>
      </webpartzone>
      <webpartzone id="zoneTextAfter" v="1">
        <webpart controlid="Javascript" guid="2219a8a4-7a1c-486a-a8e3-56e8c8aa6b16" type="javascript" v="1">
          <property name="cat_open_behavior"></property>
          <property name="cat_open_performance"></property>
          <property name="controlid">Javascript</property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">False</property>
          <property name="displaytoroles"></property>
          <property name="generatescripttags">False</property>
          <property name="hideonsubpages">False</property>
          <property name="inlinescript">
<![CDATA[
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
<script>
  $(document).ready(function () {
    $('#businessUnitPopup').removeClass('active');    
    //Bind already existed  business units
    function BindBUData() {
      var currentUserID = parseInt(decodeURIComponent(window.location.href.slice(window.location.href.indexOf('?') + 1).split('userid=')[1]));
      if(currentUserID > 0) 
      {
        $.ajax({
          type: "POST",
          url: '/KadenaWebservice.asmx/GetUserBusinessUnitData',
          contentType: "application/json; charset=utf-8",
          data: '{userID: ' + currentUserID + '}',
          dataType: "json",
          success: function (data) {
            if (data != '') {
              var parsedData=JSON.parse(data.d);
              var th="<tr><th>{$Kadena.Users.BusinessUnitNumber$}</th><th>{$Kadena.Users.BusinessUnitName$}</th></tr>";
              var rowData='';
              var ids='';
              $('#hdnbuid').val('');
              for(i=0; i<parsedData.length;i++)  {
                rowData +='<tr id='+parsedData[i].ItemID+'><td>'+parsedData[i].BusinessUnitNumber+'</td><td>'+parsedData[i].BusinessUnitName+
                  '</td></tr>';
                ids+=parsedData[i].ItemID+';';
              }
              $('#hdnbuid').val(ids);                           
              $('#UserBusinessUnitbody').append(rowData);
              $('#UserBusinessUnit').show();                           
            } else {
            }
          },
          error: function (xhr, ajaxOptions, thrownError) {            
          }
        });
      }
    }
    //Bind busienss units in pop up
    function BindBusinessUnits(){
      $.ajax({
        type: "GET",
        url: '/KadenaWebservice.asmx/GetAllActiveBusienssUnits',
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
          if (data.d != '') {
            $('#buinessunits').html('');
            var th='<tr><td><input type="checkbox" class="js-chkAll" id="selectAll"></td><td>{$Kadena.Users.BusinessUnitNumber$}</td><td>{$Kadena.Users.BusinessUnitName$}</td></tr>';
            var parsedData=JSON.parse(data.d);          
            var rowData='';
            for(i=0; i<parsedData.length;i++)
              rowData +='<tr><td><input type="checkbox" class="js-chk" value='+parsedData[i].ItemID+'></td><td class=js-td>'+parsedData[i].BusinessUnitNumber+'</td><td class=js-td>'+parsedData[i].BusinessUnitName+
                '</td></tr>';
            if(rowData != ''){
              $('#buinessunits').append(th+rowData);
            } 
            if($('#hdnbuid').val()!=''){
              var arr=$('#hdnbuid').val().split(';');
              $('.js-chk:checkbox', buinessunits).each(function(){
                if(jQuery.inArray($(this).val(), arr) >= 0)
                  $(this).prop("checked", true);
              });
            }
            
          } else {            
          }
        },
        error: function (xhr, ajaxOptions, thrownError) {          
        }
      });
    }
    //Show pop up
    $(document).on('click', ".js-btnAssignBU", function (e) {
      e.preventDefault();
      $('#businessUnitPopup').toggleClass('active');
    });
    
    //Close the pop up
    $(document).on('click', ".js-btnClose", function () {            
      $('#businessUnitPopup').toggleClass('active');
    });
    
    //check/uncheck all check boxes
    $(document).on('change', ".js-chkAll", function () {         
      $('input:checkbox').not(this).prop('checked', this.checked);      
    });
    //Save business units
    $(document).on('click', ".js-btnSaveBU", function () {      
      var itemID='';
      $('#UserBusinessUnitbody').html('');
      var th='<tr><th>{$Kadena.Users.BusinessUnitNumber$}</th><th>{$Kadena.Users.BusinessUnitName$}</th></tr>';
      var tbody='';
      $('#UserBusinessUnitbody').append('')
        $('.js-chk:checkbox:checked', buinessunits).each(function() {
          itemID+=$(this).val()+';';
          var rowData='';
          $(this).closest('tr').children('.js-td').each(function(){
            rowData +='<td>'+$(this).html()+'</td>';          
          });   
          tbody+='<tr>'+rowData+'</tr>';
        });
      if(tbody != ''){
        $('#UserBusinessUnitbody').append(th+tbody);
        $('#UserBusinessUnit').show();
      }
      $('#hdnbuid').val(itemID);
      $('#businessUnitPopup').toggleClass('active');
    });
    
    BindBUData();
    BindBusinessUnits();
    $('#businessUnitPopup').removeClass('active');
  });
</script>
]]>
          </property>
          <property name="inlinescriptpagelocation">Beginning</property>
          <property name="instanceguid">2219a8a4-7a1c-486a-a8e3-56e8c8aa6b16</property>
          <property name="linkedfile"></property>
          <property name="linkedfilepagelocation">Header</property>
          <property name="showfordocumenttypes"></property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">javascript</property>
        </webpart>
        <webpart controlid="jsUserRoleSelector" guid="764d2ec2-beb8-435a-96e6-da54bf7c9c7c" type="javascript" v="1">
          <property name="cat_open_behavior"></property>
          <property name="cat_open_performance"></property>
          <property name="controlid">jsUserRoleSelector</property>
          <property name="disablemacros">False</property>
          <property name="disableviewstate">False</property>
          <property name="displaytoroles"></property>
          <property name="generatescripttags">False</property>
          <property name="hideonsubpages">False</property>
          <property name="inlinescript">
<![CDATA[
<script type="text/javascript">
  $(window).ready(function() {
    var userRoleSelector=document.getElementsByClassName("js-user-role");
    var userRole=document.getElementById("hdnUserRole").value;
    if(userRole!="" && userRoleSelector!=undefined && userRoleSelector.length>0)
    {
      document.getElementsByClassName("js-user-role")[0].value=userRole;
    }
  });
  
</script>
]]>
          </property>
          <property name="inlinescriptpagelocation">Inline</property>
          <property name="instanceguid">764d2ec2-beb8-435a-96e6-da54bf7c9c7c</property>
          <property name="linkedfile"></property>
          <property name="linkedfilepagelocation">Startup</property>
          <property name="showfordocumenttypes"></property>
          <property name="visible">True</property>
          <property name="webparttitle"></property>
          <property name="webparttype">javascript</property>
        </webpart>
      </webpartzone>
    </page>
  </PageTemplateWebParts>
</cms.pagetemplate>